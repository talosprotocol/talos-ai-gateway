{
  "schema_id": "talos.gateway.surface_registry",
  "schema_version": "v1",
  "routes": [
    {
      "method": "GET",
      "path_template": "/v1/secrets/{secret_id}",
      "permission": "secrets.read",
      "scope_template": {
        "scope_type": "secret",
        "attributes": { "secret_id": "{secret_id}" }
      }
    },
    {
      "method": "POST",
      "path_template": "/v1/secrets",
      "permission": "secrets.write",
      "scope_template": {
        "scope_type": "global",
        "attributes": {}
      }
    },
    {
      "method": "DELETE",
      "path_template": "/v1/secrets/{secret_id}",
      "permission": "secrets.delete",
      "scope_template": {
        "scope_type": "secret",
        "attributes": { "secret_id": "{secret_id}" }
      }
    },
    {
      "method": "GET",
      "path_template": "/v1/audit",
      "permission": "audit.read",
      "scope_template": {
        "scope_type": "global",
        "attributes": {}
      }
    },
    {
      "method": "GET",
      "path_template": "/v1/audit/{event_id}",
      "permission": "audit.read",
      "scope_template": {
        "scope_type": "global",
        "attributes": {}
      }
    },
    {
      "method": "POST",
      "path_template": "/v1/audit/export",
      "permission": "audit.export",
      "scope_template": {
        "scope_type": "global",
        "attributes": {}
      }
    },
    {
      "method": "POST",
      "path_template": "/a2a/v1/sessions",
      "permission": "a2a.session.create",
      "scope_template": {
        "scope_type": "principal",
        "attributes": { "principal_id": "{actor_id}" }
      }
    },
    {
      "method": "GET",
      "path_template": "/a2a/v1/sessions/{id}",
      "permission": "a2a.session.read",
      "scope_template": {
        "scope_type": "session",
        "attributes": { "session_id": "{id}" }
      }
    },
    {
      "method": "POST",
      "path_template": "/a2a/v1/sessions/{id}/accept",
      "permission": "a2a.session.accept",
      "scope_template": {
        "scope_type": "session",
        "attributes": { "session_id": "{id}" }
      }
    },
    {
      "method": "POST",
      "path_template": "/a2a/v1/sessions/{id}/rotate",
      "permission": "a2a.session.rotate",
      "scope_template": {
        "scope_type": "session",
        "attributes": { "session_id": "{id}" }
      }
    },
    {
      "method": "DELETE",
      "path_template": "/a2a/v1/sessions/{id}",
      "permission": "a2a.session.close",
      "scope_template": {
        "scope_type": "session",
        "attributes": { "session_id": "{id}" }
      }
    },
    {
      "method": "POST",
      "path_template": "/a2a/v1/sessions/{id}/frames",
      "permission": "a2a.frame.send",
      "scope_template": {
        "scope_type": "session",
        "attributes": { "session_id": "{id}" }
      }
    },
    {
      "method": "GET",
      "path_template": "/a2a/v1/sessions/{id}/frames",
      "permission": "a2a.frame.receive",
      "scope_template": {
        "scope_type": "session",
        "attributes": { "session_id": "{id}" }
      }
    },
    {
      "method": "POST",
      "path_template": "/a2a/v1/groups",
      "permission": "a2a.group.create",
      "scope_template": {
        "scope_type": "principal",
        "attributes": { "principal_id": "{actor_id}" }
      }
    },
    {
      "method": "GET",
      "path_template": "/a2a/v1/groups/{id}",
      "permission": "a2a.group.read",
      "scope_template": {
        "scope_type": "group",
        "attributes": { "group_id": "{id}" }
      }
    },
    {
      "method": "POST",
      "path_template": "/a2a/v1/groups/{id}/members",
      "permission": "a2a.group.manage",
      "scope_template": {
        "scope_type": "group",
        "attributes": { "group_id": "{id}" }
      }
    },
    {
      "method": "DELETE",
      "path_template": "/a2a/v1/groups/{id}/members/{pid}",
      "permission": "a2a.group.manage",
      "scope_template": {
        "scope_type": "group",
        "attributes": { "group_id": "{id}" }
      }
    },
    {
      "method": "DELETE",
      "path_template": "/a2a/v1/groups/{id}",
      "permission": "a2a.group.close",
      "scope_template": {
        "scope_type": "group",
        "attributes": { "group_id": "{id}" }
      }
    }
  ]
}
