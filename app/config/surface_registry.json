{
  "schema_id": "talos.gateway.surface_registry",
  "schema_version": "v1",
  "routes": [
    {
      "method": "GET",
      "path_template": "/v1/secrets/{secret_id}",
      "permission": "secrets.read",
      "scope_template": {
        "scope_type": "secret",
        "attributes": { "secret_id": "{secret_id}" }
      }
    },
    {
      "method": "POST",
      "path_template": "/v1/secrets",
      "permission": "secrets.write",
      "scope_template": {
        "scope_type": "global",
        "attributes": {}
      }
    },
    {
      "method": "DELETE",
      "path_template": "/v1/secrets/{secret_id}",
      "permission": "secrets.delete",
      "scope_template": {
        "scope_type": "secret",
        "attributes": { "secret_id": "{secret_id}" }
      }
    },
    {
      "method": "GET",
      "path_template": "/v1/audit",
      "permission": "audit.read",
      "scope_template": {
        "scope_type": "global",
        "attributes": {}
      }
    },
    {
      "method": "GET",
      "path_template": "/v1/audit/{event_id}",
      "permission": "audit.read",
      "scope_template": {
        "scope_type": "global",
        "attributes": {}
      }
    },
    {
      "method": "POST",
      "path_template": "/v1/audit/export",
      "permission": "audit.export",
      "scope_template": {
        "scope_type": "global",
        "attributes": {}
      }
    }
  ]
}
